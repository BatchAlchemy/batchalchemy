Search.setIndex({"docnames": ["deobfuscator", "experimental", "formatting", "index", "optimizer", "tests", "utils"], "filenames": ["deobfuscator.rst", "experimental.rst", "formatting.rst", "index.rst", "optimizer.rst", "tests.rst", "utils.rst"], "titles": ["Deobfuscator", "Experimental", "Formatting", "Welcome to Batchger\u2019s documentation!", "Optimizer", "Tests", "Utils"], "terms": {"thi": [0, 1, 2, 3, 4, 5, 6], "modul": [0, 1, 2, 3, 4, 5, 6], "contain": [0, 1, 2, 3, 4, 5, 6], "function": [0, 1, 2, 3, 5, 6], "batch": [0, 1, 2, 3, 4, 5, 6], "file": [0, 1, 2, 3, 4, 5, 6], "command_name_clean": [0, 3], "src": [0, 1, 2, 3, 4, 5, 6], "encod": [0, 1, 2, 4, 5, 6], "utf": [0, 1, 2, 4, 5, 6], "8": [0, 1, 2, 4, 5, 6], "sourc": [0, 1, 2, 4, 5, 6], "remov": [0, 2, 5, 6], "caret": [0, 2, 5], "charact": [0, 2, 6], "meant": [0, 1, 2, 5, 6], "escap": [0, 2], "from": [0, 5], "command": [0, 1, 2, 3, 4, 5], "name": [0, 2, 3, 5], "detect": [0, 2, 4, 6], "ast": [0, 2, 3, 4, 5, 6], "given": [0, 2, 3, 4, 5, 6], "paramet": [0, 1, 2, 4, 5, 6], "string": [0, 1, 2, 4, 5, 6], "represent": [0, 2, 4, 6], "return": [0, 1, 2, 4, 5, 6], "process": [0, 2, 3, 4, 6], "query_variable_assign": [0, 3], "stream": [0, 2, 6], "log": [0, 2, 6], "current": [0, 2, 3, 6], "state": [0, 2, 6], "queri": [0, 2, 6], "ani": [0, 2, 3, 6], "variabl": [0, 1, 2, 3, 6], "assign": [0, 3], "which": [0, 2, 3, 5, 6], "ar": [0, 1, 2, 3, 5, 6], "right": [0, 2, 6], "now": [0, 2, 6], "print": [0, 2, 3, 6], "all": [0, 2, 3, 5, 6], "found": [0, 2, 3, 6], "occurr": [0, 2, 6], "follow": [0, 2, 3, 5], "": [0, 1, 2, 5, 6], "express": [0, 2, 3], "valu": [0, 2, 3, 6], "either": [0, 2, 5, 6], "stdout": [0, 2, 5, 6], "debug": [0, 2, 6], "level": [0, 2, 3, 6], "separ": [0, 2, 3, 5, 6], "newlin": [0, 2, 6], "each": [0, 2, 5, 6], "us": [0, 1, 2, 3, 4, 5, 6], "within": [0, 1, 2, 4, 5], "decod": [0, 1, 2, 4], "default": [0, 1, 2, 4, 5, 6], "i": [0, 1, 2, 3, 4, 5, 6], "specifi": [0, 2, 5, 6], "list": [0, 2, 3, 6], "should": [0, 2, 5, 6], "possibl": [0, 2, 6], "via": [0, 2, 3, 6], "root": [0, 2, 6], "logger": [0, 2, 6], "standard": [0, 2, 6], "output": [0, 2, 5, 6], "note": [0, 2, 3, 5, 6], "must": [0, 2, 6], "set": [0, 2, 3, 5, 6], "actual": [0, 2, 6], "make": [0, 2, 3, 6], "result": [0, 2, 3, 5, 6], "visibl": [0, 2, 6], "none": [0, 1, 2, 5, 6], "variable_substitut": [0, 1, 3], "env": [0, 1], "expand_loc": 0, "fals": [0, 2], "expand_env": 0, "placehold": [0, 2], "b": [0, 2, 5], "an": [0, 2, 3, 5], "input": [0, 2, 6], "unset": 0, "enclos": [0, 6], "parenthes": 0, "environ": [0, 3], "give": 0, "option": 0, "expand": [0, 3], "local": 0, "describ": 0, "have": [0, 2, 3, 5], "been": 0, "up": [0, 3], "until": [0, 3], "step": 0, "whether": [0, 2, 5], "type": 0, "leav": 0, "them": [0, 3, 5], "can": [0, 1, 2, 3], "decid": 0, "two": [0, 2, 3, 5], "flag": 0, "individu": [0, 2], "dictionari": 0, "substitut": [0, 1, 3, 6], "updat": [0, 2], "dure": [0, 1, 5], "so": [0, 3], "bool": 0, "were": 0, "If": 0, "true": 0, "onli": [0, 1, 2, 5], "pair": 0, "occur": [0, 2], "previous": [0, 5], "taken": [0, 2], "account": [0, 2], "caution": [0, 2], "mean": 0, "case": [0, 2, 3, 5], "non": 0, "linear": 0, "code": [0, 4, 5], "execut": [0, 3, 5], "expans": [0, 2], "guarante": [0, 2], "work": [0, 3, 5], "also": 0, "ha": [0, 3], "lower": [0, 2, 5], "preced": 0, "concern": [0, 2], "order": 0, "than": 0, "due": [0, 5], "dynam": 0, "ascii": [0, 2], "byte": [0, 2], "liter": [0, 2], "temporarili": [0, 2], "mark": [0, 2, 5], "posit": [0, 2], "after": [0, 2, 3, 5], "done": [0, 2], "everi": [0, 2, 5], "singl": [0, 2], "get": [0, 2, 3, 5], "replac": [0, 2, 6], "origin": 0, "The": [0, 2, 5, 6], "anywher": [0, 2], "product": 1, "test": [1, 3], "demonstr": 1, "purpos": [1, 5, 6], "modify_nod": [1, 3], "experi": 1, "tree": [1, 2, 3, 5, 6], "sitter": [1, 2, 3, 5, 6], "node": [1, 2, 3], "travers": 1, "ignor": 1, "variable_expand": [1, 3], "rewrit": 1, "deobfusc": [1, 2, 3, 5, 6], "format_sexp": [2, 3], "input_str": 2, "indent_s": 2, "4": [2, 5], "valid": 2, "again": 2, "one": [2, 5], "line": [2, 3, 5, 6], "semant": [2, 6], "same": 2, "ad": 2, "indent": 2, "visual": [2, 5, 6], "appeal": 2, "structur": 2, "help": 2, "sexp": 2, "method": [2, 3, 5], "liner": 2, "integ": 2, "size": 2, "suit": 2, "query_separ": [2, 3], "remove_separ": [2, 3], "identifi": [2, 3], "just": [2, 5], "run": 2, "repres": [2, 3], "length": 2, "1": [2, 5], "group": 2, "whitespac": 2, "To": [2, 3], "correct": [2, 5], "to_lower_cas": [2, 3, 5], "forc": 2, "keyword": [2, 5], "errorlevel": 2, "cmdextvers": 2, "defin": 2, "exist": [2, 3, 5], "els": 2, "rule": [2, 3, 5], "command_nam": [2, 3], "cmdname": 2, "comment": [2, 3], "label_definit": 2, "label": [2, 3], "transform": [2, 4, 6], "its": [2, 3, 6], "content": 2, "For": [2, 3], "three": 2, "differ": [2, 3], "mode": 2, "avail": [2, 3], "first": [2, 3, 5, 6], "simpli": [2, 6], "across": 2, "entir": [2, 3], "In": 2, "enabl": 2, "other": [2, 3, 6], "being": 2, "skip": 2, "automat": 2, "second": [2, 3], "third": [2, 5], "tandem": 2, "One": 2, "number": [2, 5], "wai": [2, 5], "match": 2, "last": 2, "parser": [2, 3, 5, 6], "aim": [2, 3], "prevent": 2, "loss": 2, "inform": 2, "relev": 2, "sensit": 2, "implement": [2, 3, 4, 5], "fulli": 2, "correctli": 2, "thu": [2, 5, 6], "yield": [2, 3], "stabl": 2, "solut": 2, "todo": 2, "assum": 2, "certain": 2, "degre": 2, "previou": 2, "resolv": 2, "henc": 2, "regex": 2, "re": 2, "sub": 2, "itself": 2, "bewar": 2, "chang": [2, 6], "rang": [2, 5], "aka": 2, "boolean": 2, "iter": 2, "do": [2, 5], "equ": 2, "neq": 2, "lss": 2, "lew": 2, "gtr": 2, "geq": 2, "becaus": [2, 3, 6], "ones": [2, 3], "remain": 2, "typic": [2, 3], "includ": [2, 3, 5], "consist": [2, 3], "out": 2, "alphabet": 2, "immedi": 2, "thereaft": 2, "check": [2, 5], "pars": [2, 3, 5], "wherea": 2, "part": [2, 3, 5], "specif": [2, 3], "place": 2, "correspond": 2, "close": 2, "parenthesi": 2, "marker": 2, "stai": 2, "definit": 2, "project": 3, "revolv": 3, "around": 3, "framework": 3, "develop": 3, "script": [3, 6], "languag": [3, 6], "obfusc": [3, 5, 6], "emphasi": 3, "li": 3, "ensur": 3, "oper": 3, "base": 3, "abstract": 3, "syntax": [3, 6], "compris": 3, "main": [3, 5], "compon": 3, "toolbox": 3, "techniqu": 3, "built": 3, "link": 3, "homepag": 3, "http": [3, 5], "github": [3, 5], "io": 3, "gener": 3, "tool": [3, 6], "design": 3, "It": 3, "written": [3, 5], "javascript": 3, "leverag": 3, "j": [3, 5], "provid": 3, "primarili": 3, "handl": 3, "almost": 3, "relat": [3, 5], "aspect": 3, "accord": [3, 5], "grammar": [3, 5], "u": 3, "mostli": 3, "emploi": 3, "regular": 3, "lowest": 3, "start": [3, 6], "source_fil": 3, "gradual": 3, "divid": 3, "call": [3, 5], "statement": 3, "further": 3, "broken": 3, "down": 3, "finer": 3, "grain": 3, "reach": 3, "exampl": 3, "ec": 3, "var_not_set": 3, "ho": 3, "rem": 3, "would": 3, "uncondit": 3, "symbol": 3, "simpl": 3, "window": 3, "prompt": 3, "cmd": 3, "ex": [3, 5], "insid": 3, "null": 3, "empti": 3, "becom": 3, "echo": [3, 5], "ON": 3, "off": 3, "basic": 3, "build": [3, 6], "block": 3, "syntact": 3, "element": 3, "These": 3, "among": 3, "loop": 3, "condit": 3, "more": 3, "A": [3, 5], "complet": 3, "locat": [3, 5], "yet": 3, "submit": 3, "offici": 3, "contribut": 3, "manual": [3, 5], "detail": 3, "guid": 3, "under": 3, "creat": 3, "sum": 3, "you": 3, "navig": 3, "folder": [3, 5], "sure": 3, "fulfil": 3, "prerequisit": 3, "see": [3, 5], "depend": 3, "instal": 3, "corpu": 3, "batchger42": 3, "collect": 3, "extens": 3, "defeat": 3, "reason": 3, "maintain": 3, "usabl": 3, "pure": 3, "python": 3, "goal": 3, "upon": 3, "releas": 3, "analyst": 3, "allow": 3, "knowledg": 3, "swiss": 3, "armi": 3, "knife": 3, "new": 3, "without": 3, "rigidli": 3, "focus": 3, "scenario": 3, "when": 3, "encount": 3, "malwar": [3, 5], "research": 3, "api": 3, "util": 3, "write": 3, "e": 3, "extend": 3, "optim": [3, 5], "togeth": 3, "respons": 3, "featur": 3, "usag": 3, "explain": 3, "below": 3, "involv": 3, "five": 3, "categori": 3, "seen": 3, "experiment": 3, "format": 3, "constant_fold": [3, 4], "test_abobu": [3, 5], "test_baum1810": [3, 5], "test_baum1810_obfuscated_malware_sampl": [3, 5], "test_count_errors_per_fil": [3, 5], "test_either_missing_unexpect": [3, 5], "test_missing_onli": [3, 5], "test_parser_correct": [3, 5], "test_redirect": [3, 5], "test_to_lower_cas": [3, 5], "test_unary_identifier_express": [3, 5], "create_pars": [3, 6], "query_variable_substitut": [3, 6], "remove_baum1810_overhead": [3, 6], "replace_first_occurr": [3, 6], "index": 3, "search": [3, 6], "page": 3, "variou": 4, "appli": [4, 5, 6], "constant": 4, "fold": 4, "evalu": 5, "abobu": 5, "pipelin": 5, "static": 5, "As": 5, "refer": 5, "wa": 5, "com": 5, "escalag": 5, "mechan": 5, "random_at": 5, "random_semicolon": 5, "cleaning_com": 5, "lower_upper_charact": 5, "china_symbol": 5, "malici": 5, "evil": 5, "stuff": 5, "tmp": 5, "bat": 5, "goto": 5, "l": 5, "beneign": 5, "noth": 5, "here": 5, "twice": 5, "ll": 5, "baum1810": [5, 6], "batchobfusc": 5, "entireti": 5, "did": 5, "git": 5, "add": 5, "zip": 5, "sinc": [5, 6], "don": 5, "t": 5, "know": 5, "illeg": 5, "upload": 5, "uni": 5, "info": 5, "gitlab": 5, "lower_bound": 5, "upper_bound": 5, "chapter": 5, "front": 5, "end": 5, "take": 5, "directori": 5, "count": 5, "how": 5, "mani": 5, "error": 5, "appear": 5, "By": 5, "argument": 5, "interv": 5, "tell": 5, "final": 5, "miss": 5, "unexpect": 5, "analysi": 5, "realiz": 5, "concept": 5, "particular": 5, "worth": 5, "closer": 5, "look": 5, "hint": 5, "where": 5, "probabl": 5, "bit": 5, "too": 5, "rigid": 5, "On": 5, "top": 5, "eval": 5, "prepend": 5, "miss_unexp_": 5, "param": [5, 6], "missing_only_": 5, "utf8": 5, "grab": 5, "couldn": 5, "unicod": 5, "decodeerror": 5, "put": 5, "lastli": 5, "least": 5, "copi": 5, "eval_error": 5, "redirect": 5, "redir_err_": 5, "temporari": 5, "address": 5, "tricki": 5, "token": 5, "cast": 5, "upper": 5, "easili": 5, "got": 5, "flawlessli": 5, "unary_identifier_express": 5, "unary_id_err_": 5, "well": 6, "object": 6, "befor": 6, "batch_lang": 6, "signatur": 6, "real": 6, "malform": 6, "original_str": 6, "old_substr": 6, "new_substr": 6, "text": 6, "edit": 6}, "objects": {"": [[0, 0, 0, "-", "deobfuscator"], [1, 0, 0, "-", "experimental"], [2, 0, 0, "-", "formatting"], [4, 0, 0, "-", "optimizer"], [5, 0, 0, "-", "tests"], [6, 0, 0, "-", "utils"]], "deobfuscator": [[0, 1, 1, "", "command_name_cleaner"], [0, 1, 1, "", "query_variable_assignments"], [0, 1, 1, "", "variable_substitution"]], "experimental": [[1, 1, 1, "", "modify_nodes"], [1, 1, 1, "", "variable_expander"]], "formatting": [[2, 1, 1, "", "format_sexp"], [2, 1, 1, "", "query_separators"], [2, 1, 1, "", "remove_separators"], [2, 1, 1, "", "to_lower_case"]], "optimizer": [[4, 1, 1, "", "constant_folding"]], "tests": [[5, 1, 1, "", "test_abobus"], [5, 1, 1, "", "test_baum1810"], [5, 1, 1, "", "test_baum1810_obfuscated_malware_samples"], [5, 1, 1, "", "test_count_errors_per_file"], [5, 1, 1, "", "test_either_missing_unexpected"], [5, 1, 1, "", "test_missing_only"], [5, 1, 1, "", "test_parser_correctness"], [5, 1, 1, "", "test_redirection"], [5, 1, 1, "", "test_to_lower_case"], [5, 1, 1, "", "test_unary_identifier_expression"]], "utils": [[6, 1, 1, "", "create_parser"], [6, 1, 1, "", "query_variable_substitutions"], [6, 1, 1, "", "remove_baum1810_overhead"], [6, 1, 1, "", "replace_first_occurrence"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"deobfusc": 0, "experiment": 1, "format": 2, "welcom": 3, "batchger": 3, "": 3, "document": 3, "The": 3, "frontend": 3, "backend": 3, "content": 3, "indic": 3, "tabl": 3, "optim": 4, "test": 5, "util": 6}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.todo": 2, "sphinx": 60}, "alltitles": {"Deobfuscator": [[0, "module-deobfuscator"]], "Experimental": [[1, "module-experimental"]], "Formatting": [[2, "module-formatting"]], "Welcome to Batchger\u2019s documentation!": [[3, "welcome-to-batchger-s-documentation"]], "The frontend": [[3, "the-frontend"]], "The backend": [[3, "the-backend"]], "Contents:": [[3, null]], "Indices and tables": [[3, "indices-and-tables"]], "Optimizer": [[4, "module-optimizer"]], "Tests": [[5, "module-tests"]], "Utils": [[6, "module-utils"]]}, "indexentries": {"command_name_cleaner() (in module deobfuscator)": [[0, "deobfuscator.command_name_cleaner"]], "deobfuscator": [[0, "module-deobfuscator"]], "module": [[0, "module-deobfuscator"], [1, "module-experimental"], [2, "module-formatting"], [4, "module-optimizer"], [5, "module-tests"], [6, "module-utils"]], "query_variable_assignments() (in module deobfuscator)": [[0, "deobfuscator.query_variable_assignments"]], "variable_substitution() (in module deobfuscator)": [[0, "deobfuscator.variable_substitution"]], "experimental": [[1, "module-experimental"]], "modify_nodes() (in module experimental)": [[1, "experimental.modify_nodes"]], "variable_expander() (in module experimental)": [[1, "experimental.variable_expander"]], "format_sexp() (in module formatting)": [[2, "formatting.format_sexp"]], "formatting": [[2, "module-formatting"]], "query_separators() (in module formatting)": [[2, "formatting.query_separators"]], "remove_separators() (in module formatting)": [[2, "formatting.remove_separators"]], "to_lower_case() (in module formatting)": [[2, "formatting.to_lower_case"]], "constant_folding() (in module optimizer)": [[4, "optimizer.constant_folding"]], "optimizer": [[4, "module-optimizer"]], "test_abobus() (in module tests)": [[5, "tests.test_abobus"]], "test_baum1810() (in module tests)": [[5, "tests.test_baum1810"]], "test_baum1810_obfuscated_malware_samples() (in module tests)": [[5, "tests.test_baum1810_obfuscated_malware_samples"]], "test_count_errors_per_file() (in module tests)": [[5, "tests.test_count_errors_per_file"]], "test_either_missing_unexpected() (in module tests)": [[5, "tests.test_either_missing_unexpected"]], "test_missing_only() (in module tests)": [[5, "tests.test_missing_only"]], "test_parser_correctness() (in module tests)": [[5, "tests.test_parser_correctness"]], "test_redirection() (in module tests)": [[5, "tests.test_redirection"]], "test_to_lower_case() (in module tests)": [[5, "tests.test_to_lower_case"]], "test_unary_identifier_expression() (in module tests)": [[5, "tests.test_unary_identifier_expression"]], "tests": [[5, "module-tests"]], "create_parser() (in module utils)": [[6, "utils.create_parser"]], "query_variable_substitutions() (in module utils)": [[6, "utils.query_variable_substitutions"]], "remove_baum1810_overhead() (in module utils)": [[6, "utils.remove_baum1810_overhead"]], "replace_first_occurrence() (in module utils)": [[6, "utils.replace_first_occurrence"]], "utils": [[6, "module-utils"]]}})